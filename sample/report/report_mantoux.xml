<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <template id="report_mantoux">
            <t t-call="report.html_container">
                <t t-call="legh.external_layout_pathology">
                    <t t-foreach="docs" t-as="o">
                        <div class="page">

                            <!-- Department Header -->

                            <!-- ✅ MAIN REPORT BLOCK -->
                            <div style="width: 80%; margin-left: 60px; margin-top: 25px;
                                        font-size: 15px; font-family: Helvetica;">

                                <!-- Report Title -->
                                <h4 style="text-align: center; margin-bottom: 20px; font-size: 18px;">
                                    CLINICAL PATHOLOGY
                                </h4>

                                <!-- ✅ Report Table -->
                                <table style="width: 100%; border-collapse: collapse;">
                                    <t t-foreach="o.sticker_line_id" t-as="z">
                                        <tr style="border-bottom: 1px solid #ddd; height: 30px;">

                                            <!-- ✅ Test Name -->
                                            <td style="width: 35%; padding: 8px 10px; font-weight: bold;">
                                                <t t-esc="z.test_name"/>:
                                            </td>

                                            <!-- ✅ Result -->
                                            <td style="width: 65%; padding: 8px 10px;">

                                                <!-- Site -->
                                                <t t-if="z.test_name=='Site' and not z.result">
                                                    Left Fore Arm
                                                </t>

                                                <!-- Date of Injection -->
                                                <t t-if="z.test_name=='Date of Injection'">
                                                    <span t-esc="z.result"/>
                                                </t>

                                                <!-- Dose of Injection -->
                                                <t t-if="z.test_name=='Dose of Injection' and not z.result">
                                                    PPD 0.1 ml = 10 TU
                                                </t>

                                                <!-- Date of Observation -->
                                                <t t-if="z.test_name=='Date of Observation'">
                                                    <span t-esc="z.result"/>
                                                </t>

                                                <!-- ✅ If Induration Present -->
                                                <t t-if="o.induration_present">

                                                    <!-- On Observation -->
                                                    <t t-if="z.test_name=='On Observation' and not z.result">
                                                        Induration Present
                                                    </t>

                                                    <!-- Diameter -->
                                                    <t t-if="z.test_name=='Diameter'">
                                                        <span t-esc="z.result"/>
                                                    </t>

                                                    <!-- Interpretation -->
                                                    <t t-if="z.test_name=='Interpretation' and not z.result">
                                                        Positive
                                                    </t>

                                                </t>

                                                <!-- ✅ If No Induration Present -->
                                                <t t-if="not o.induration_present">

                                                    <!-- On Observation -->
                                                    <t t-if="z.test_name=='On Observation' and not z.result">
                                                        No Induration Present
                                                    </t>

                                                    <!-- Interpretation -->
                                                    <t t-if="z.test_name=='Interpretation' and not z.result">
                                                        Negative
                                                    </t>

                                                </t>

                                                <!-- ✅ Default: show z.result for others -->
                                                <t t-if="z.result and z.test_name not in ['Site','Dose of Injection','On Observation','Interpretation','Diameter']">
                                                    <span t-esc="z.result"/>
                                                </t>

                                            </td>
                                        </tr>
                                    </t>
                                </table>
                            </div>

                            <!-- Comments Section -->
                            <div style="width: 85%; margin: 20px auto; font-size: 15px;
                                        line-height: 1.6; color: #333; font-family: Helvetica;">
                                <t t-if="o.comments_sc_date">
                                    <p>
                                        <strong>Comments:</strong>
                                        Schedule date of observation <span t-field="o.comments_sc_date"/>
                                        but the patient reported on <span t-field="o.comments_rp_date"/>.
                                    </p>
                                </t>

                                <t t-if="o.advice">
                                    <p><strong>Advice:</strong> <span t-field="o.advice"/></p>
                                </t>
                            </div>

                        </div>
                    </t>
                </t>
            </t>
        </template>
    </data>
</openerp>
